#!/usr/bin/env python3
"""
Generate placeholder NES CHR (Character ROM) tile data for Zelda 2B.

NES CHR format: Each 8x8 tile is 16 bytes.
  - Bytes 0-7:  bit plane 0 (low bit of each pixel, one byte per row)
  - Bytes 8-15: bit plane 1 (high bit of each pixel, one byte per row)
  - Pixel value = (bit1 << 1) | bit0, giving values 0-3

Output:
  assets/chr/placeholder.chr  - 8192 bytes (both banks)
  assets/chr/bg_tiles.chr     - 4096 bytes (background tiles only)
  assets/chr/sprite_tiles.chr - 4096 bytes (sprite tiles only)
"""

import os
import struct
import sys

# ---------------------------------------------------------------------------
# Helpers
# ---------------------------------------------------------------------------

def pixels_to_tile(rows):
    """Convert an 8x8 grid of pixel values (0-3) into 16 bytes of CHR data.

    *rows* is a list of 8 elements.  Each element is a list/tuple of 8 ints
    in the range 0-3.
    """
    assert len(rows) == 8, f"Expected 8 rows, got {len(rows)}"
    plane0 = bytearray(8)
    plane1 = bytearray(8)
    for y, row in enumerate(rows):
        assert len(row) == 8, f"Row {y}: expected 8 pixels, got {len(row)}"
        b0 = 0
        b1 = 0
        for x, px in enumerate(row):
            bit = 7 - x
            b0 |= ((px & 1) << bit)
            b1 |= (((px >> 1) & 1) << bit)
        plane0[y] = b0
        plane1[y] = b1
    return bytes(plane0) + bytes(plane1)


def empty_tile():
    return bytes(16)


def solid_tile(color=3):
    """All pixels set to *color*."""
    rows = [[color] * 8 for _ in range(8)]
    return pixels_to_tile(rows)


def checkerboard_tile(c1=0, c2=1):
    rows = []
    for y in range(8):
        row = []
        for x in range(8):
            row.append(c2 if (x + y) % 2 else c1)
        rows.append(row)
    return pixels_to_tile(rows)


def half_solid_h(color=2):
    """Top half solid, bottom half empty."""
    rows = [[color]*8 if y < 4 else [0]*8 for y in range(8)]
    return pixels_to_tile(rows)


def half_solid_v(color=2):
    """Left half solid, right half empty."""
    rows = [[color]*4 + [0]*4 for _ in range(8)]
    return pixels_to_tile(rows)


# ---------------------------------------------------------------------------
# Border tiles ($05-$08): top, bottom, left, right
# ---------------------------------------------------------------------------

def border_top():
    rows = [
        [1,1,1,1,1,1,1,1],
        [3,3,3,3,3,3,3,3],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


def border_bottom():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [3,3,3,3,3,3,3,3],
        [1,1,1,1,1,1,1,1],
    ]
    return pixels_to_tile(rows)


def border_left():
    rows = [
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
        [1,3,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


def border_right():
    rows = [
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
        [0,0,0,0,0,0,3,1],
    ]
    return pixels_to_tile(rows)


# ---------------------------------------------------------------------------
# Special tiles
# ---------------------------------------------------------------------------

def x_pattern_tile():
    """X pattern for breakable/bombable walls."""
    rows = [
        [1,0,0,0,0,0,1,0],
        [0,1,0,0,0,1,0,0],
        [0,0,1,0,1,0,0,0],
        [0,0,0,2,0,0,0,0],
        [0,0,1,0,1,0,0,0],
        [0,1,0,0,0,1,0,0],
        [1,0,0,0,0,0,1,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


def door_tile():
    """Archway / door entrance."""
    rows = [
        [0,1,1,1,1,1,1,0],
        [1,3,3,3,3,3,3,1],
        [1,3,0,0,0,0,3,1],
        [1,0,0,0,0,0,0,1],
        [1,0,0,0,0,0,0,1],
        [1,0,0,0,0,0,0,1],
        [1,0,0,0,0,0,0,1],
        [1,0,0,0,0,0,0,1],
    ]
    return pixels_to_tile(rows)


def chest_tile():
    """Simple chest with lid."""
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,1,1,1,1,1,1,0],
        [1,3,3,3,3,3,3,1],
        [1,1,1,2,2,1,1,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,3,3,2,2,1],
        [1,2,2,2,2,2,2,1],
        [0,1,1,1,1,1,1,0],
    ]
    return pixels_to_tile(rows)


def water_frame(phase):
    """4 frames of wavy water animation."""
    # Shift the wave pattern by *phase* pixels.
    rows = []
    for y in range(8):
        row = []
        for x in range(8):
            # Create a sine-ish wave shifting each frame
            wave = (x + phase + (y // 2)) % 4
            if wave == 0:
                row.append(1)
            elif wave == 1:
                row.append(2)
            elif wave == 2:
                row.append(3)
            else:
                row.append(2)
        rows.append(row)
    return pixels_to_tile(rows)


# ---------------------------------------------------------------------------
# HUD / item tiles
# ---------------------------------------------------------------------------

def heart_tile():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,1,1,0,1,1,0,0],
        [1,3,3,1,3,3,1,0],
        [1,3,3,3,3,3,1,0],
        [1,3,3,3,3,3,1,0],
        [0,1,3,3,3,1,0,0],
        [0,0,1,3,1,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)


def heart_empty_tile():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,1,1,0,1,1,0,0],
        [1,0,0,1,0,0,1,0],
        [1,0,0,0,0,0,1,0],
        [1,0,0,0,0,0,1,0],
        [0,1,0,0,0,1,0,0],
        [0,0,1,0,1,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)


def magic_bottle_filled():
    rows = [
        [0,0,1,1,1,0,0,0],
        [0,0,1,3,1,0,0,0],
        [0,1,1,1,1,1,0,0],
        [0,1,3,3,3,1,0,0],
        [0,1,2,3,2,1,0,0],
        [0,1,2,2,2,1,0,0],
        [0,1,2,2,2,1,0,0],
        [0,0,1,1,1,0,0,0],
    ]
    return pixels_to_tile(rows)


def magic_bottle_empty():
    rows = [
        [0,0,1,1,1,0,0,0],
        [0,0,1,0,1,0,0,0],
        [0,1,1,1,1,1,0,0],
        [0,1,0,0,0,1,0,0],
        [0,1,0,0,0,1,0,0],
        [0,1,0,0,0,1,0,0],
        [0,1,0,0,0,1,0,0],
        [0,0,1,1,1,0,0,0],
    ]
    return pixels_to_tile(rows)


def rupee_tile():
    rows = [
        [0,0,0,1,0,0,0,0],
        [0,0,1,3,1,0,0,0],
        [0,1,3,2,3,1,0,0],
        [0,1,2,3,2,1,0,0],
        [0,1,3,2,3,1,0,0],
        [0,1,2,3,2,1,0,0],
        [0,0,1,3,1,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)


def bomb_tile():
    rows = [
        [0,0,0,1,1,0,0,0],
        [0,0,0,0,1,3,0,0],
        [0,0,1,1,1,0,0,0],
        [0,1,2,2,2,1,0,0],
        [0,1,2,3,2,1,0,0],
        [0,1,2,2,2,1,0,0],
        [0,1,2,2,2,1,0,0],
        [0,0,1,1,1,0,0,0],
    ]
    return pixels_to_tile(rows)


def arrow_up_tile():
    rows = [
        [0,0,0,1,0,0,0,0],
        [0,0,1,3,1,0,0,0],
        [0,1,1,3,1,1,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,0,2,0,0,0,0],
        [0,0,1,2,1,0,0,0],
    ]
    return pixels_to_tile(rows)


def key_tile():
    rows = [
        [0,0,1,1,1,0,0,0],
        [0,1,3,0,3,1,0,0],
        [0,1,0,0,0,1,0,0],
        [0,0,1,3,1,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,1,3,0,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,1,3,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# ---------------------------------------------------------------------------
# Font: ASCII characters  ($20-$5F)
# A-Z at $20-$39,  0-9 at $3A-$43,  punctuation fills the rest
# ---------------------------------------------------------------------------

# Each glyph is an 8-row list of 8 pixels.
# Color 0 = transparent, color 3 = foreground, colors 1/2 for accents.

FONT_GLYPHS = {}

# --- A-Z ---
FONT_GLYPHS['A'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['B'] = [
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['C'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['D'] = [
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['E'] = [
    [0,1,3,3,3,3,1,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['F'] = [
    [0,1,3,3,3,3,1,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['G'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,3,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['H'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['I'] = [
    [0,0,1,3,3,1,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['J'] = [
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['K'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,1,3,0,0],
    [0,1,3,1,3,0,0,0],
    [0,1,3,3,1,0,0,0],
    [0,1,3,1,3,0,0,0],
    [0,1,3,0,1,3,0,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['L'] = [
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['M'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,3,1,0],
    [0,1,3,2,2,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['N'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,0,3,1,0],
    [0,1,3,2,3,3,1,0],
    [0,1,3,0,2,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['O'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['P'] = [
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['Q'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,2,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,3,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['R'] = [
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,3,3,1,0,0],
    [0,1,3,1,3,0,0,0],
    [0,1,3,0,1,3,0,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['S'] = [
    [0,0,1,3,3,3,1,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,1,3,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['T'] = [
    [0,1,3,3,3,3,1,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['U'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['V'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,3,0,0,3,0,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['W'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,2,2,3,1,0],
    [0,1,3,3,3,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['X'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['Y'] = [
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['Z'] = [
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,1,3,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,1,3,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,0,0,0],
]

# --- 0-9 ---
FONT_GLYPHS['0'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,1,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,1,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['1'] = [
    [0,0,0,3,0,0,0,0],
    [0,0,1,3,0,0,0,0],
    [0,1,3,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,1,3,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['2'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,1,3,1,0,0],
    [0,0,1,3,0,0,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['3'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,1,3,1,0,0],
    [0,0,0,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['4'] = [
    [0,0,0,0,1,3,0,0],
    [0,0,0,1,3,3,0,0],
    [0,0,1,3,0,3,0,0],
    [0,1,3,0,0,3,0,0],
    [0,1,3,3,3,3,3,0],
    [0,0,0,0,0,3,0,0],
    [0,0,0,0,0,3,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['5'] = [
    [0,1,3,3,3,3,1,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,1,0,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['6'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,0,0,0],
    [0,1,3,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['7'] = [
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,1,3,0,0],
    [0,0,0,0,3,0,0,0],
    [0,0,0,1,3,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['8'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['9'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,1,3,0,0,3,1,0],
    [0,0,1,3,3,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,1,3,3,1,0,0],
    [0,0,0,0,0,0,0,0],
]

# --- Punctuation ---
FONT_GLYPHS['!'] = [
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['"'] = [
    [0,0,3,0,3,0,0,0],
    [0,0,3,0,3,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS["'"] = [
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS[','] = [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,1,0,0,0,0,0],
]
FONT_GLYPHS['.'] = [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['?'] = [
    [0,0,1,3,3,1,0,0],
    [0,1,3,0,0,3,1,0],
    [0,0,0,0,0,3,1,0],
    [0,0,0,1,3,1,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['-'] = [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,1,3,3,3,3,1,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS[':'] = [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS['/'] = [
    [0,0,0,0,0,0,3,0],
    [0,0,0,0,0,3,0,0],
    [0,0,0,0,3,0,0,0],
    [0,0,0,3,0,0,0,0],
    [0,0,3,0,0,0,0,0],
    [0,3,0,0,0,0,0,0],
    [3,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]
FONT_GLYPHS[' '] = [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
]


def make_font_tiles():
    """Return a dict mapping tile index (0x20-0x5F) to tile data.

    Layout:
      $20-$39: A-Z  (26 letters)
      $3A-$43: 0-9  (10 digits)
      $44-$5F: punctuation and blanks
    """
    tiles = {}
    # A-Z
    for i, ch in enumerate("ABCDEFGHIJKLMNOPQRSTUVWXYZ"):
        tiles[0x20 + i] = pixels_to_tile(FONT_GLYPHS[ch])
    # 0-9
    for i, ch in enumerate("0123456789"):
        tiles[0x3A + i] = pixels_to_tile(FONT_GLYPHS[ch])
    # punctuation ($44 onward)
    punct = " !\"',.?-:/"
    for i, ch in enumerate(punct):
        tiles[0x44 + i] = pixels_to_tile(FONT_GLYPHS[ch])
    # Fill remaining $4E-$5F with empty
    for idx in range(0x4E, 0x60):
        if idx not in tiles:
            tiles[idx] = empty_tile()
    return tiles


# ---------------------------------------------------------------------------
# Decorative tiles ($60-$6F)
# ---------------------------------------------------------------------------

def grass_tuft_1():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,2,0,0,2,0,0],
        [0,2,3,0,0,3,2,0],
        [0,2,3,2,2,3,2,0],
        [2,3,2,3,3,2,3,2],
        [0,2,0,2,2,0,2,0],
    ]
    return pixels_to_tile(rows)

def grass_tuft_2():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,2,0,0,0,0,0],
        [0,2,3,2,0,2,0,0],
        [0,2,3,2,2,3,2,0],
        [2,3,2,3,3,2,3,0],
        [0,2,3,2,2,3,2,0],
        [0,0,2,0,0,2,0,0],
    ]
    return pixels_to_tile(rows)

def stone_tile():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,1,1,1,1,0,0],
        [0,1,2,2,2,2,1,0],
        [0,1,2,3,3,2,1,0],
        [0,1,2,3,3,2,1,0],
        [0,1,2,2,2,2,1,0],
        [0,0,1,1,1,1,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def tree_top_left():
    rows = [
        [0,0,0,0,1,2,2,2],
        [0,0,0,1,2,3,3,3],
        [0,0,1,2,3,3,3,3],
        [0,1,2,3,3,3,3,3],
        [0,1,2,3,3,2,3,3],
        [1,2,3,3,2,3,3,3],
        [1,2,3,3,3,3,3,3],
        [1,2,3,3,3,3,3,3],
    ]
    return pixels_to_tile(rows)

def tree_top_right():
    rows = [
        [2,2,2,1,0,0,0,0],
        [3,3,3,2,1,0,0,0],
        [3,3,3,3,2,1,0,0],
        [3,3,3,3,3,2,1,0],
        [3,3,2,3,3,2,1,0],
        [3,3,3,2,3,3,2,1],
        [3,3,3,3,3,3,2,1],
        [3,3,3,3,3,3,2,1],
    ]
    return pixels_to_tile(rows)

def tree_bottom_left():
    rows = [
        [1,2,3,3,3,3,3,3],
        [1,2,3,3,3,3,3,3],
        [0,1,2,3,3,3,3,3],
        [0,1,2,3,3,3,3,3],
        [0,0,1,2,2,1,1,0],
        [0,0,0,1,2,1,0,0],
        [0,0,0,1,2,1,0,0],
        [0,0,0,1,2,1,0,0],
    ]
    return pixels_to_tile(rows)

def tree_bottom_right():
    rows = [
        [3,3,3,3,3,3,2,1],
        [3,3,3,3,3,3,2,1],
        [3,3,3,3,3,2,1,0],
        [3,3,3,3,3,2,1,0],
        [0,1,1,2,2,1,0,0],
        [0,0,1,2,1,0,0,0],
        [0,0,1,2,1,0,0,0],
        [0,0,1,2,1,0,0,0],
    ]
    return pixels_to_tile(rows)

def bush_tile():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,1,1,1,1,0,0],
        [0,1,2,3,3,2,1,0],
        [1,2,3,2,2,3,2,1],
        [1,2,3,3,3,3,2,1],
        [1,2,3,2,3,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,1,1,1,0,0],
    ]
    return pixels_to_tile(rows)

def flowers_tile():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,3,0,0,0,3,0,0],
        [3,2,3,0,3,2,3,0],
        [0,3,0,0,0,3,0,0],
        [0,1,0,0,0,1,0,0],
        [0,1,0,3,0,1,0,0],
        [0,0,0,2,0,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def fence_tile():
    rows = [
        [0,1,0,1,0,1,0,1],
        [0,2,0,2,0,2,0,2],
        [0,2,0,2,0,2,0,2],
        [2,2,2,2,2,2,2,2],
        [0,2,0,2,0,2,0,2],
        [0,2,0,2,0,2,0,2],
        [2,2,2,2,2,2,2,2],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def path_tile():
    rows = [
        [2,2,1,2,2,2,1,2],
        [2,2,2,2,1,2,2,2],
        [1,2,2,2,2,2,2,1],
        [2,2,2,1,2,2,2,2],
        [2,1,2,2,2,1,2,2],
        [2,2,2,2,2,2,2,2],
        [2,2,2,1,2,2,2,1],
        [1,2,2,2,2,1,2,2],
    ]
    return pixels_to_tile(rows)

def sand_tile():
    rows = [
        [2,2,2,3,2,2,2,2],
        [2,2,2,2,2,2,3,2],
        [2,3,2,2,2,2,2,2],
        [2,2,2,2,3,2,2,2],
        [2,2,2,2,2,2,2,3],
        [3,2,2,2,2,2,2,2],
        [2,2,3,2,2,3,2,2],
        [2,2,2,2,2,2,2,2],
    ]
    return pixels_to_tile(rows)

def crack_tile():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,1,0,0,0,0],
        [0,0,1,0,0,0,0,0],
        [0,0,1,1,0,0,0,0],
        [0,0,0,1,1,0,0,0],
        [0,0,0,0,1,0,0,0],
        [0,0,0,0,0,1,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# ---------------------------------------------------------------------------
# Sprite tiles
# ---------------------------------------------------------------------------

# Player sprites: 16x16 = 4 tiles (TL, TR, BL, BR), top-down perspective
# Color 0 = transparent, 1 = outline/dark, 2 = mid tone, 3 = highlight

# --- Player facing down ---
def player_down_tl():
    rows = [
        [0,0,0,1,1,1,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,1,3,3,3,1,1],
        [0,0,1,2,1,2,1,0],
        [0,0,1,2,2,2,1,0],
        [0,0,0,1,2,1,0,0],
    ]
    return pixels_to_tile(rows)

def player_down_tr():
    rows = [
        [0,1,1,1,0,0,0,0],
        [1,3,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,1,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,0,1,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_down_bl():
    """Lower-left of player facing down: torso and left leg."""
    rows = [
        [0,0,1,3,3,3,1,0],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,2,3,2,2,1],
        [0,0,1,2,0,2,1,0],
        [0,0,1,2,0,2,1,0],
        [0,0,1,1,0,1,1,0],
    ]
    return pixels_to_tile(rows)

def player_down_br():
    """Lower-right of player facing down: torso and right leg."""
    rows = [
        [0,1,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,2,2,1,0,0],
        [1,2,3,2,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,1,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

# --- Player facing up ---
def player_up_tl():
    rows = [
        [0,0,0,1,1,1,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,0,1,3,3,3,1,0],
        [0,0,1,2,2,2,1,0],
        [0,0,0,1,2,1,0,0],
    ]
    return pixels_to_tile(rows)

def player_up_tr():
    rows = [
        [0,1,1,1,0,0,0,0],
        [1,3,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [0,1,3,3,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,0,1,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_up_bl():
    rows = [
        [0,0,1,3,3,3,1,0],
        [0,1,2,3,3,3,2,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,2,3,2,2,1],
        [0,0,1,2,0,2,1,0],
        [0,0,1,2,0,2,1,0],
        [0,0,1,1,0,1,1,0],
    ]
    return pixels_to_tile(rows)

def player_up_br():
    rows = [
        [0,1,3,3,1,0,0,0],
        [1,2,3,3,2,1,0,0],
        [1,2,3,3,2,1,0,0],
        [1,2,3,3,2,1,0,0],
        [1,2,3,2,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,1,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

# --- Player facing right ---
def player_right_tl():
    rows = [
        [0,0,1,1,1,1,0,0],
        [0,1,3,3,3,3,1,0],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,0,1,3,3,2,1,0],
        [0,0,1,2,2,1,1,0],
        [0,0,1,2,2,1,0,0],
        [0,0,0,1,1,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_right_tr():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [1,2,0,0,0,0,0,0],
        [1,2,1,0,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_right_bl():
    rows = [
        [0,0,1,3,3,3,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,2,3,3,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,2,0,2,1,0],
        [0,0,0,2,0,1,2,0],
        [0,0,1,1,0,0,1,1],
    ]
    return pixels_to_tile(rows)

def player_right_br():
    rows = [
        [0,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

# --- Player walking frame 2 (down) ---
def player_walk2_down_tl():
    rows = [
        [0,0,0,1,1,1,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,1,3,3,3,1,1],
        [0,0,1,2,1,2,1,0],
        [0,0,1,2,2,2,1,0],
        [0,0,0,1,2,1,0,0],
    ]
    return pixels_to_tile(rows)

def player_walk2_down_tr():
    rows = [
        [0,1,1,1,0,0,0,0],
        [1,3,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,1,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,0,1,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_walk2_down_bl():
    rows = [
        [0,0,1,3,3,3,1,0],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,2,3,2,2,1],
        [0,0,1,2,0,2,1,0],
        [0,1,2,0,0,0,2,1],
        [0,1,1,0,0,0,1,1],
    ]
    return pixels_to_tile(rows)

def player_walk2_down_br():
    rows = [
        [0,1,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,2,2,1,0,0],
        [1,2,3,2,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [1,2,0,0,0,0,0,0],
        [1,1,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# --- Player sword swing (down) ---
def player_sword_down_tl():
    rows = [
        [0,0,0,1,1,1,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,1,3,3,3,1,1],
        [0,0,1,2,1,2,1,0],
        [0,0,1,2,2,2,1,0],
        [0,0,0,1,2,1,0,0],
        [0,0,1,3,3,3,1,0],
    ]
    return pixels_to_tile(rows)

def player_sword_down_tr():
    rows = [
        [0,1,1,1,0,0,0,0],
        [1,3,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,1,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_sword_down_bl():
    rows = [
        [0,1,3,3,3,3,3,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,2,3,2,2,1],
        [0,0,1,2,0,2,1,0],
        [0,0,1,2,0,2,1,0],
        [0,0,1,1,0,1,1,0],
        [0,0,0,3,0,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_sword_down_br():
    rows = [
        [1,3,3,3,3,1,0,0],
        [1,3,3,2,2,1,0,0],
        [1,2,3,2,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# --- Player sword swing (up) ---
def player_sword_up_tl():
    rows = [
        [0,0,0,1,0,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,1,3,1,1,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,0,1,3,3,3,1,0],
        [0,0,1,2,2,2,1,0],
    ]
    return pixels_to_tile(rows)

def player_sword_up_tr():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [1,3,3,3,1,0,0,0],
        [1,3,3,3,3,1,0,0],
        [1,3,3,3,3,1,0,0],
        [0,1,3,3,1,0,0,0],
        [0,1,2,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_sword_up_bl():
    rows = [
        [0,0,1,3,3,3,1,0],
        [0,1,2,3,3,3,2,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,3,3,3,2,1],
        [0,1,2,2,3,2,2,1],
        [0,0,1,2,0,2,1,0],
        [0,0,1,2,0,2,1,0],
        [0,0,1,1,0,1,1,0],
    ]
    return pixels_to_tile(rows)

def player_sword_up_br():
    rows = [
        [0,1,3,3,1,0,0,0],
        [1,2,3,3,2,1,0,0],
        [1,2,3,3,2,1,0,0],
        [1,2,3,3,2,1,0,0],
        [1,2,3,2,1,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,2,1,0,0,0,0],
        [0,1,1,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# --- Player sword swing (right) ---
def player_sword_right_tl():
    rows = [
        [0,0,1,1,1,1,0,0],
        [0,1,3,3,3,3,1,0],
        [0,1,3,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,0,1,3,3,2,1,0],
        [0,0,1,2,2,1,1,0],
        [0,0,1,2,2,1,0,0],
        [0,0,0,1,1,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_sword_right_tr():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,3],
        [1,2,0,0,0,1,3,0],
        [1,2,1,0,1,3,0,0],
        [0,1,2,1,3,0,0,0],
        [0,0,1,3,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def player_sword_right_bl():
    rows = [
        [0,0,1,3,3,3,1,0],
        [0,0,1,3,3,3,3,1],
        [0,1,3,3,3,3,3,1],
        [0,1,2,3,3,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,2,0,2,1,0],
        [0,0,1,2,0,1,2,0],
        [0,0,1,1,0,0,1,1],
    ]
    return pixels_to_tile(rows)

def player_sword_right_br():
    rows = [
        [0,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# --- Simple enemy (octorok-like), 16x16, 4 directions ---
# Octorok: round body with small legs, top-down

def enemy_down_tl():
    rows = [
        [0,0,1,1,1,1,0,0],
        [0,1,2,2,2,2,1,0],
        [1,2,1,2,2,1,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,2,1,2,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_down_tr():
    rows = [
        [0,0,1,1,0,0,0,0],
        [0,1,2,2,1,0,0,0],
        [1,2,1,2,2,1,0,0],
        [1,2,2,2,2,1,0,0],
        [1,2,2,2,2,1,0,0],
        [1,2,2,2,2,1,0,0],
        [0,1,2,2,1,0,0,0],
        [0,0,1,2,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_down_bl():
    rows = [
        [0,0,0,2,0,2,0,0],
        [0,0,1,1,1,1,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_down_br():
    rows = [
        [0,0,2,0,0,0,0,0],
        [0,0,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_up_tl():
    rows = [
        [0,0,1,1,1,1,0,0],
        [0,1,2,2,2,2,1,0],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,2,1,2,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_up_tr():
    rows = [
        [0,0,1,1,0,0,0,0],
        [0,1,2,2,1,0,0,0],
        [1,2,2,2,2,1,0,0],
        [1,2,2,2,2,1,0,0],
        [1,2,2,2,2,1,0,0],
        [1,2,2,2,2,1,0,0],
        [0,1,2,2,1,0,0,0],
        [0,0,1,2,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_up_bl():
    rows = [
        [0,0,0,2,0,2,0,0],
        [0,0,1,1,1,1,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_up_br():
    rows = [
        [0,0,2,0,0,0,0,0],
        [0,0,1,1,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_right_tl():
    rows = [
        [0,0,1,1,1,1,0,0],
        [0,1,2,2,2,2,1,0],
        [1,2,2,2,1,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,2,1,2,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_right_tr():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,1,0,0,0,0,0,0],
        [1,2,1,0,0,0,0,0],
        [1,2,1,0,0,0,0,0],
        [1,2,1,0,0,0,0,0],
        [0,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_right_bl():
    rows = [
        [0,0,0,2,0,2,0,0],
        [0,0,1,1,1,1,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_right_br():
    return empty_tile()

# Enemy left = mirror of right; just reuse with a tweak
def enemy_left_tl():
    rows = [
        [0,0,1,1,1,1,0,0],
        [0,1,2,2,2,2,1,0],
        [1,2,2,1,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [1,2,2,2,2,2,2,1],
        [0,1,2,2,2,2,1,0],
        [0,0,1,2,1,2,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_left_tr():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_left_bl():
    rows = [
        [0,0,0,2,0,2,0,0],
        [0,0,1,1,1,1,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def enemy_left_br():
    return empty_tile()


# --- Projectile (4 animation frames) ---
def projectile_frame(n):
    """Small fireball/rock, 8x8, 4 frames rotating pattern."""
    base = [
        [0,0,0,0,0,0,0,0],
        [0,0,1,1,1,0,0,0],
        [0,1,3,3,3,1,0,0],
        [0,1,3,2,3,1,0,0],
        [0,1,3,3,3,1,0,0],
        [0,0,1,1,1,0,0,0],
        [0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0],
    ]
    # Rotate the highlights slightly per frame
    rows = [row[:] for row in base]
    if n == 1:
        rows[2][3] = 2; rows[3][4] = 2
    elif n == 2:
        rows[4][3] = 2; rows[3][2] = 2
    elif n == 3:
        rows[2][3] = 2; rows[3][2] = 2
    return pixels_to_tile(rows)


# --- Item pickup sprites ---
def item_heart_sprite():
    rows = [
        [0,0,0,0,0,0,0,0],
        [0,1,1,0,1,1,0,0],
        [1,3,3,1,3,3,1,0],
        [1,3,3,3,3,3,1,0],
        [1,3,3,3,3,3,1,0],
        [0,1,3,3,3,1,0,0],
        [0,0,1,3,1,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def item_rupee_sprite():
    rows = [
        [0,0,0,1,0,0,0,0],
        [0,0,1,3,1,0,0,0],
        [0,1,2,3,2,1,0,0],
        [0,1,3,2,3,1,0,0],
        [0,1,2,3,2,1,0,0],
        [0,1,3,2,3,1,0,0],
        [0,0,1,3,1,0,0,0],
        [0,0,0,1,0,0,0,0],
    ]
    return pixels_to_tile(rows)

def item_bomb_sprite():
    rows = [
        [0,0,0,1,1,0,0,0],
        [0,0,0,0,1,3,0,0],
        [0,0,1,1,1,0,0,0],
        [0,1,2,2,2,1,0,0],
        [0,1,2,3,2,1,0,0],
        [0,1,2,2,2,1,0,0],
        [0,1,2,2,2,1,0,0],
        [0,0,1,1,1,0,0,0],
    ]
    return pixels_to_tile(rows)

def item_key_sprite():
    rows = [
        [0,0,1,1,1,0,0,0],
        [0,1,3,0,3,1,0,0],
        [0,1,0,0,0,1,0,0],
        [0,0,1,3,1,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,1,3,0,0,0,0],
        [0,0,0,3,0,0,0,0],
        [0,0,1,3,0,0,0,0],
    ]
    return pixels_to_tile(rows)


# --- Explosion / poof (4 frames) ---
def explosion_frame(n):
    if n == 0:
        rows = [
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,1,1,0,0,0],
            [0,0,1,3,3,1,0,0],
            [0,0,1,3,3,1,0,0],
            [0,0,0,1,1,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
        ]
    elif n == 1:
        rows = [
            [0,0,0,0,0,0,0,0],
            [0,0,1,0,0,1,0,0],
            [0,1,3,1,1,3,1,0],
            [0,0,1,3,3,1,0,0],
            [0,0,1,3,3,1,0,0],
            [0,1,3,1,1,3,1,0],
            [0,0,1,0,0,1,0,0],
            [0,0,0,0,0,0,0,0],
        ]
    elif n == 2:
        rows = [
            [0,1,0,0,0,0,1,0],
            [0,0,1,0,0,1,0,0],
            [0,0,0,2,2,0,0,0],
            [0,0,2,3,3,2,0,0],
            [0,0,2,3,3,2,0,0],
            [0,0,0,2,2,0,0,0],
            [0,0,1,0,0,1,0,0],
            [0,1,0,0,0,0,1,0],
        ]
    else:
        rows = [
            [1,0,0,0,0,0,0,1],
            [0,0,0,0,0,0,0,0],
            [0,0,1,0,0,1,0,0],
            [0,0,0,2,2,0,0,0],
            [0,0,0,2,2,0,0,0],
            [0,0,1,0,0,1,0,0],
            [0,0,0,0,0,0,0,0],
            [1,0,0,0,0,0,0,1],
        ]
    return pixels_to_tile(rows)


# --- Sword projectile (4 frames/directions) ---
def sword_projectile(n):
    """Sword beam projectile. 4 frames for spinning."""
    if n == 0:  # horizontal
        rows = [
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,1,3,3,3,3,1,0],
            [0,1,3,3,3,3,1,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
        ]
    elif n == 1:  # diagonal
        rows = [
            [0,0,0,0,0,1,3,0],
            [0,0,0,0,1,3,0,0],
            [0,0,0,1,3,0,0,0],
            [0,0,1,3,0,0,0,0],
            [0,1,3,0,0,0,0,0],
            [1,3,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
        ]
    elif n == 2:  # vertical
        rows = [
            [0,0,0,1,1,0,0,0],
            [0,0,0,3,3,0,0,0],
            [0,0,0,3,3,0,0,0],
            [0,0,0,3,3,0,0,0],
            [0,0,0,3,3,0,0,0],
            [0,0,0,1,1,0,0,0],
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
        ]
    else:  # other diagonal
        rows = [
            [0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0],
            [1,3,0,0,0,0,0,0],
            [0,1,3,0,0,0,0,0],
            [0,0,1,3,0,0,0,0],
            [0,0,0,1,3,0,0,0],
            [0,0,0,0,1,3,0,0],
            [0,0,0,0,0,1,3,0],
        ]
    return pixels_to_tile(rows)


# ---------------------------------------------------------------------------
# Build the full CHR banks
# ---------------------------------------------------------------------------

def build_bg_bank():
    """Build the 4096-byte background tile bank (256 tiles)."""
    tiles = [empty_tile()] * 256

    # $00 empty (already done)
    tiles[0x01] = solid_tile(3)
    tiles[0x02] = checkerboard_tile(0, 1)
    tiles[0x03] = half_solid_h(2)
    tiles[0x04] = half_solid_v(2)

    # $05-$08 borders
    tiles[0x05] = border_top()
    tiles[0x06] = border_bottom()
    tiles[0x07] = border_left()
    tiles[0x08] = border_right()

    # $09 X pattern
    tiles[0x09] = x_pattern_tile()

    # $0A door
    tiles[0x0A] = door_tile()

    # $0B chest
    tiles[0x0B] = chest_tile()

    # $0C-$0F water frames
    for i in range(4):
        tiles[0x0C + i] = water_frame(i)

    # $10-$17 HUD / item tiles
    tiles[0x10] = heart_tile()
    tiles[0x11] = heart_empty_tile()
    tiles[0x12] = magic_bottle_filled()
    tiles[0x13] = magic_bottle_empty()
    tiles[0x14] = rupee_tile()
    tiles[0x15] = bomb_tile()
    tiles[0x16] = arrow_up_tile()
    tiles[0x17] = key_tile()

    # $20-$5F font
    font = make_font_tiles()
    for idx, data in font.items():
        tiles[idx] = data

    # $60-$6F decorative
    tiles[0x60] = grass_tuft_1()
    tiles[0x61] = grass_tuft_2()
    tiles[0x62] = stone_tile()
    tiles[0x63] = tree_top_left()
    tiles[0x64] = tree_top_right()
    tiles[0x65] = tree_bottom_left()
    tiles[0x66] = tree_bottom_right()
    tiles[0x67] = bush_tile()
    tiles[0x68] = flowers_tile()
    tiles[0x69] = fence_tile()
    tiles[0x6A] = path_tile()
    tiles[0x6B] = sand_tile()
    tiles[0x6C] = crack_tile()
    # $6D-$6F remain empty

    return b"".join(tiles)


def build_sprite_bank():
    """Build the 4096-byte sprite tile bank (256 tiles)."""
    tiles = [empty_tile()] * 256

    # Player facing down ($00-$03)
    tiles[0x00] = player_down_tl()
    tiles[0x01] = player_down_tr()
    tiles[0x02] = player_down_bl()
    tiles[0x03] = player_down_br()

    # Player facing up ($04-$07)
    tiles[0x04] = player_up_tl()
    tiles[0x05] = player_up_tr()
    tiles[0x06] = player_up_bl()
    tiles[0x07] = player_up_br()

    # Player facing right ($08-$0B)
    tiles[0x08] = player_right_tl()
    tiles[0x09] = player_right_tr()
    tiles[0x0A] = player_right_bl()
    tiles[0x0B] = player_right_br()

    # Player walking frame 2 down ($0C-$0F)
    tiles[0x0C] = player_walk2_down_tl()
    tiles[0x0D] = player_walk2_down_tr()
    tiles[0x0E] = player_walk2_down_bl()
    tiles[0x0F] = player_walk2_down_br()

    # Player sword swing down ($10-$13)
    tiles[0x10] = player_sword_down_tl()
    tiles[0x11] = player_sword_down_tr()
    tiles[0x12] = player_sword_down_bl()
    tiles[0x13] = player_sword_down_br()

    # Player sword swing up ($14-$17)
    tiles[0x14] = player_sword_up_tl()
    tiles[0x15] = player_sword_up_tr()
    tiles[0x16] = player_sword_up_bl()
    tiles[0x17] = player_sword_up_br()

    # Player sword swing right ($18-$1B)
    tiles[0x18] = player_sword_right_tl()
    tiles[0x19] = player_sword_right_tr()
    tiles[0x1A] = player_sword_right_bl()
    tiles[0x1B] = player_sword_right_br()

    # Enemy down ($20-$23)
    tiles[0x20] = enemy_down_tl()
    tiles[0x21] = enemy_down_tr()
    tiles[0x22] = enemy_down_bl()
    tiles[0x23] = enemy_down_br()

    # Enemy up ($24-$27)
    tiles[0x24] = enemy_up_tl()
    tiles[0x25] = enemy_up_tr()
    tiles[0x26] = enemy_up_bl()
    tiles[0x27] = enemy_up_br()

    # Enemy right ($28-$2B)
    tiles[0x28] = enemy_right_tl()
    tiles[0x29] = enemy_right_tr()
    tiles[0x2A] = enemy_right_bl()
    tiles[0x2B] = enemy_right_br()

    # Enemy left ($2C-$2F)
    tiles[0x2C] = enemy_left_tl()
    tiles[0x2D] = enemy_left_tr()
    tiles[0x2E] = enemy_left_bl()
    tiles[0x2F] = enemy_left_br()

    # Projectile frames ($30-$33)
    for i in range(4):
        tiles[0x30 + i] = projectile_frame(i)

    # Item pickups ($40-$43)
    tiles[0x40] = item_heart_sprite()
    tiles[0x41] = item_rupee_sprite()
    tiles[0x42] = item_bomb_sprite()
    tiles[0x43] = item_key_sprite()

    # Explosion / poof ($50-$53)
    for i in range(4):
        tiles[0x50 + i] = explosion_frame(i)

    # Sword projectile ($60-$63)
    for i in range(4):
        tiles[0x60 + i] = sword_projectile(i)

    return b"".join(tiles)


# ---------------------------------------------------------------------------
# Main
# ---------------------------------------------------------------------------

def main():
    script_dir = os.path.dirname(os.path.abspath(__file__))
    project_root = os.path.dirname(script_dir)
    chr_dir = os.path.join(project_root, "assets", "chr")
    os.makedirs(chr_dir, exist_ok=True)

    bg_data = build_bg_bank()
    sprite_data = build_sprite_bank()
    combined = bg_data + sprite_data

    assert len(bg_data) == 4096, f"BG bank is {len(bg_data)} bytes, expected 4096"
    assert len(sprite_data) == 4096, f"Sprite bank is {len(sprite_data)} bytes, expected 4096"
    assert len(combined) == 8192, f"Combined is {len(combined)} bytes, expected 8192"

    path_combined = os.path.join(chr_dir, "placeholder.chr")
    path_bg = os.path.join(chr_dir, "bg_tiles.chr")
    path_sprite = os.path.join(chr_dir, "sprite_tiles.chr")

    with open(path_combined, "wb") as f:
        f.write(combined)
    with open(path_bg, "wb") as f:
        f.write(bg_data)
    with open(path_sprite, "wb") as f:
        f.write(sprite_data)

    # -----------------------------------------------------------------------
    # Summary
    # -----------------------------------------------------------------------
    print("=" * 60)
    print("  Zelda 2B - Placeholder CHR Data Generator")
    print("=" * 60)
    print()
    print(f"  Output directory: {chr_dir}")
    print()
    print(f"  placeholder.chr   {len(combined):>5} bytes  (both banks)")
    print(f"  bg_tiles.chr      {len(bg_data):>5} bytes  (background only)")
    print(f"  sprite_tiles.chr  {len(sprite_data):>5} bytes  (sprites only)")
    print()
    print("  BACKGROUND TILES (first 4KB = 256 tiles):")
    print("  ------------------------------------------")
    print("  $00       Empty (transparent)")
    print("  $01       Solid (color 3)")
    print("  $02       Checkerboard (color 1)")
    print("  $03       Half-solid horizontal (wall top)")
    print("  $04       Half-solid vertical (wall side)")
    print("  $05-$08   Border tiles (top, bottom, left, right)")
    print("  $09       X pattern (breakable/bombable wall)")
    print("  $0A       Door / entrance archway")
    print("  $0B       Chest")
    print("  $0C-$0F   Water animation (4 frames)")
    print("  $10       Heart (filled)")
    print("  $11       Heart (empty outline)")
    print("  $12       Magic bottle (filled)")
    print("  $13       Magic bottle (empty)")
    print("  $14       Rupee / gem")
    print("  $15       Bomb")
    print("  $16       Arrow (up)")
    print("  $17       Key")
    print("  $20-$39   Font: A-Z")
    print("  $3A-$43   Font: 0-9")
    print("  $44-$4D   Font: punctuation (space ! \" ' , . ? - : /)")
    print("  $60-$6C   Decorative (grass, stone, tree, bush, flowers,")
    print("             fence, path, sand, cracks)")
    print("  $6D-$FF   Empty (reserved)")
    print()
    print("  SPRITE TILES (second 4KB = 256 tiles):")
    print("  ----------------------------------------")
    print("  $00-$03   Player facing down (16x16)")
    print("  $04-$07   Player facing up (16x16)")
    print("  $08-$0B   Player facing right (16x16, mirror for left)")
    print("  $0C-$0F   Player walking frame 2 (down, 16x16)")
    print("  $10-$13   Player sword swing (down, 16x16)")
    print("  $14-$17   Player sword swing (up, 16x16)")
    print("  $18-$1B   Player sword swing (right, 16x16)")
    print("  $20-$23   Enemy (octorok) facing down (16x16)")
    print("  $24-$27   Enemy facing up (16x16)")
    print("  $28-$2B   Enemy facing right (16x16)")
    print("  $2C-$2F   Enemy facing left (16x16)")
    print("  $30-$33   Projectile (4 animation frames)")
    print("  $40-$43   Item pickups (heart, rupee, bomb, key)")
    print("  $50-$53   Explosion / poof (4 frames)")
    print("  $60-$63   Sword projectile (4 frames)")
    print("  $64-$FF   Empty (reserved)")
    print()

    # Count non-empty tiles
    bg_used = sum(1 for i in range(256) if bg_data[i*16:(i+1)*16] != bytes(16))
    sp_used = sum(1 for i in range(256) if sprite_data[i*16:(i+1)*16] != bytes(16))
    print(f"  Non-empty background tiles: {bg_used} / 256")
    print(f"  Non-empty sprite tiles:     {sp_used} / 256")
    print(f"  Total non-empty tiles:      {bg_used + sp_used} / 512")
    print()
    print("  Done!")
    print()


if __name__ == "__main__":
    main()
